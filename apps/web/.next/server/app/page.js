(()=>{var e={};e.id=974,e.ids=[974],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},4735:e=>{"use strict";e.exports=require("events")},9021:e=>{"use strict";e.exports=require("fs")},1630:e=>{"use strict";e.exports=require("http")},5591:e=>{"use strict";e.exports=require("https")},3873:e=>{"use strict";e.exports=require("path")},1997:e=>{"use strict";e.exports=require("punycode")},7910:e=>{"use strict";e.exports=require("stream")},6136:e=>{"use strict";e.exports=require("timers")},9551:e=>{"use strict";e.exports=require("url")},8354:e=>{"use strict";e.exports=require("util")},1185:e=>{"use strict";e.exports=require("worker_threads")},4075:e=>{"use strict";e.exports=require("zlib")},3024:e=>{"use strict";e.exports=require("node:fs")},7075:e=>{"use strict";e.exports=require("node:stream")},7830:e=>{"use strict";e.exports=require("node:stream/web")},4602:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>a.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var s=r(260),i=r(8203),n=r(5155),a=r.n(n),o=r(7292),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d=["",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,5104)),"/home/ubuntu/clawd/projects/signalforge/apps/web/app/page.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,9611)),"/home/ubuntu/clawd/projects/signalforge/apps/web/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,9937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,1485,23)),"next/dist/client/components/unauthorized-error"]}],c=["/home/ubuntu/clawd/projects/signalforge/apps/web/app/page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new s.AppPageRouteModule({definition:{kind:i.RouteKind.APP_PAGE,page:"/page",pathname:"/",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7523:()=>{},3179:()=>{},9848:(e,t,r)=>{Promise.resolve().then(r.bind(r,5047))},6696:(e,t,r)=>{Promise.resolve().then(r.bind(r,6603))},9806:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,3219,23)),Promise.resolve().then(r.t.bind(r,4863,23)),Promise.resolve().then(r.t.bind(r,5155,23)),Promise.resolve().then(r.t.bind(r,802,23)),Promise.resolve().then(r.t.bind(r,9350,23)),Promise.resolve().then(r.t.bind(r,8530,23)),Promise.resolve().then(r.t.bind(r,8921,23))},2854:(e,t,r)=>{Promise.resolve().then(r.t.bind(r,6959,23)),Promise.resolve().then(r.t.bind(r,3875,23)),Promise.resolve().then(r.t.bind(r,8903,23)),Promise.resolve().then(r.t.bind(r,7174,23)),Promise.resolve().then(r.t.bind(r,4178,23)),Promise.resolve().then(r.t.bind(r,7190,23)),Promise.resolve().then(r.t.bind(r,1365,23))},6603:(e,t,r)=>{"use strict";r.d(t,{default:()=>n});var s=r(5512),i=r(8009);function n(){let[e,t]=(0,i.useState)(!1),[r,n]=(0,i.useState)(null);async function a(){t(!0),n(null);try{let e=await fetch("/api/refresh",{method:"POST"}),t=await e.json();n(`Ingested ${t.ingested}, analyzed ${t.analyzed}`),window.location.reload()}catch(e){n(e?.message??"Failed")}finally{t(!1)}}return(0,s.jsxs)("div",{style:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:6},children:[(0,s.jsx)("button",{className:"btn primary",onClick:a,disabled:e,children:e?"Refreshingâ€¦":"Refresh now"}),r?(0,s.jsx)("span",{className:"small",children:r}):null]})}},9611:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n,metadata:()=>i});var s=r(2740);r(2704);let i={title:"SignalForge",description:"High-signal RSS + Twitter (via RSS) intelligence engine"};function n({children:e}){return(0,s.jsx)("html",{lang:"en",children:(0,s.jsxs)("body",{children:[(0,s.jsx)("div",{className:"bg"}),(0,s.jsxs)("div",{className:"container",children:[e,(0,s.jsxs)("footer",{className:"footer",children:[(0,s.jsx)("span",{children:"SignalForge"}),(0,s.jsx)("span",{className:"muted",children:"\xb7"}),(0,s.jsx)("a",{className:"link",href:"https://github.com/dhirajnikam/signalforge",target:"_blank",rel:"noreferrer",children:"GitHub"})]})]})]})})}},5104:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});var s=r(2740),i=r(2971),n=r(5047);async function a(){let e=await (0,i.$)({}),t=new Date(e.generatedAt).toISOString();return(0,s.jsxs)("main",{children:[(0,s.jsxs)("header",{className:"header",children:[(0,s.jsxs)("div",{className:"hgroup",children:[(0,s.jsx)("h1",{className:"title",children:"SignalForge"}),(0,s.jsx)("p",{className:"subtitle",children:"A compact intel stream: RSS + Twitter/X via RSS bridges, stored in SQLite, optionally summarized with an LLM (auto-detected from environment)."}),(0,s.jsxs)("div",{className:"kpi",children:[(0,s.jsxs)("span",{children:["Generated: ",(0,s.jsx)("code",{children:t})]}),(0,s.jsxs)("span",{children:["Focus: ",(0,s.jsx)("code",{children:e.focus??"none"})]})]})]}),(0,s.jsxs)("div",{className:"toolbar",children:[(0,s.jsx)(n.default,{}),(0,s.jsx)("a",{className:"btn",href:"/api/health",target:"_blank",rel:"noreferrer",children:"API health"})]})]}),(0,s.jsxs)("section",{className:"grid",children:[(0,s.jsxs)("div",{className:"card panel",children:[(0,s.jsx)("h2",{style:{margin:0,fontSize:16},children:"Latest brief"}),(0,s.jsx)("div",{className:"list",children:e.items.map(e=>(0,s.jsxs)("div",{className:"item",children:[(0,s.jsx)("div",{className:"itemTop",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{children:e.url?(0,s.jsx)("a",{className:"link",href:e.url,target:"_blank",rel:"noreferrer",children:e.title??e.url}):e.title}),(0,s.jsxs)("div",{className:"meta",children:[(0,s.jsx)("span",{className:"badge",children:e.source}),(0,s.jsx)("span",{children:new Date(e.ts).toLocaleString()})]})]})}),e.summary?(0,s.jsx)("p",{className:"summary",children:e.summary}):(0,s.jsx)("p",{className:"small",children:"No summary yet (refresh to analyze)."}),e.impact?(0,s.jsxs)("p",{className:"small",children:["Impact: ",e.impact]}):null]},e.url??e.title))})]}),(0,s.jsxs)("aside",{className:"card panel",children:[(0,s.jsx)("h2",{style:{margin:0,fontSize:16},children:"How it works"}),(0,s.jsxs)("p",{className:"small",children:["Configure sources with ",(0,s.jsx)("code",{children:"SOURCES_JSON"}),". For Twitter/X, use kind ",(0,s.jsx)("code",{children:"twitter"})," which resolves to RSSHub (default) or Nitter RSS."]}),(0,s.jsx)("pre",{style:{marginTop:12,background:"rgba(0,0,0,.25)",border:"1px solid rgba(255,255,255,.12)",borderRadius:14,padding:12,overflowX:"auto",color:"rgba(234,240,255,.9)",fontSize:12,lineHeight:1.4},children:`[
  {"kind":"rss","name":"Techmeme","url":"https://www.techmeme.com/feed.xml"},
  {"kind":"twitter","name":"OpenAI","handle":"openai","provider":"auto"}
]`}),(0,s.jsxs)("p",{className:"small",style:{marginTop:12},children:["If ",(0,s.jsx)("code",{children:"OPENAI_API_KEY"})," is present in the server environment, SignalForge will generate structured summaries and predictions. Otherwise it runs in no-LLM mode."]})]})]})]})}},5047:(e,t,r)=>{"use strict";r.d(t,{default:()=>s});let s=(0,r(6760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/ubuntu/clawd/projects/signalforge/apps/web/app/refresh-button.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/ubuntu/clawd/projects/signalforge/apps/web/app/refresh-button.tsx","default")},2971:(e,t,r)=>{"use strict";r.d(t,{$:()=>i});var s=r(3341);async function i(e){let t=(0,s.Lf)().prepare(`SELECT i.title, i.url, i.source, COALESCE(i.publishedAt, i.createdAt) as ts,
              a.summary, a.impact, a.predictionsJson
       FROM items i
       LEFT JOIN analyses a ON a.itemId = i.id
       ORDER BY ts DESC
       LIMIT 12`).all(),r=e.companyOrEvent?t.filter(t=>String(t.title??"").toLowerCase().includes(e.companyOrEvent.toLowerCase())||String(t.summary??"").toLowerCase().includes(e.companyOrEvent.toLowerCase())):t;return{generatedAt:Date.now(),focus:e.companyOrEvent??null,items:r.map(e=>({title:e.title??null,url:e.url??null,source:String(e.source??""),ts:Number(e.ts),summary:e.summary??null,impact:e.impact??null,predictions:e.predictionsJson?JSON.parse(e.predictionsJson):[]}))}}},3341:(e,t,r)=>{"use strict";r.d(t,{Lf:()=>N,t4:()=>w});var s=r(5658);let i=require("better-sqlite3");var n=r.n(i),a=r(3024),o=r.n(a);let l=require("node:path");var d=r.n(l);let c=s.Ik({SQLITE_PATH:s.Yj().default("./data/signalforge.sqlite"),OPENAI_API_KEY:s.Yj().optional(),OPENAI_MODEL:s.Yj().default("gpt-4o-mini"),OPENAI_BASE_URL:s.Yj().optional(),SOURCES_JSON:s.Yj().default("[]"),RSSHUB_BASE_URL:s.Yj().default("https://rsshub.app"),NITTER_BASE_URL:s.Yj().default("https://nitter.net")}).parse(process.env);var u=r(8397);let p=new(r.n(u)());function m(e,t){return e.replace(/\/$/,"")+"/"+t.replace(/^\//,"")}async function h(e,t){return"rss"===e.kind?g(e):"web"===e.kind?b(e):"twitter"===e.kind?x(e,t):[]}async function g(e){return((await p.parseURL(e.url)).items??[]).map(t=>{let r=t.link??void 0,s=t.isoDate?Date.parse(t.isoDate):t.pubDate?Date.parse(t.pubDate):void 0,i=r??`${e.name}:${t.guid??t.title??Math.random().toString(36).slice(2)}`,n=t.contentSnippet??t.content??t["content:encoded"]??void 0;return{id:i,source:e.name,kind:"rss",title:t.title??void 0,url:r,publishedAt:Number.isFinite(s)?s:void 0,content:n,raw:t}})}async function x(e,t){let r;let s=e.provider??"auto";for(let i of function(e){let t=e.handle.replace(/^@/,"").trim(),r=m(e.rsshubBaseUrl,`/twitter/user/${encodeURIComponent(t)}`),s=m(e.nitterBaseUrl,`/${encodeURIComponent(t)}/rss`);return"rsshub"===e.provider?[r]:"nitter"===e.provider?[s]:[r,s]}({handle:e.handle,provider:s,rsshubBaseUrl:t.rsshubBaseUrl,nitterBaseUrl:t.nitterBaseUrl}))try{return((await p.parseURL(i)).items??[]).map(t=>{let r=t.link??void 0,s=t.isoDate?Date.parse(t.isoDate):t.pubDate?Date.parse(t.pubDate):void 0,i=r??`${e.name}:${t.guid??t.title??Math.random().toString(36).slice(2)}`,n=t.contentSnippet??t.content??t["content:encoded"]??void 0;return{id:i,source:e.name,kind:"twitter",title:t.title??void 0,url:r,publishedAt:Number.isFinite(s)?s:void 0,content:n,raw:t}})}catch(e){r=e}throw r??Error("No twitter feed candidate succeeded")}async function b(e){let t=await fetch(e.url,{headers:{"user-agent":"signalforge/0.2 (+https://github.com/dhirajnikam/signalforge)"}}),r=await t.text(),s=e.url,i=r.match(/<title[^>]*>([^<]*)<\/title>/i)?.[1]?.trim(),n=r.replace(/<script[\s\S]*?<\/script>/gi," ").replace(/<style[\s\S]*?<\/style>/gi," ").replace(/<[^>]+>/g," ").replace(/\s+/g," ").trim().slice(0,6e3);return[{id:s,source:e.name,kind:"web",title:i,url:e.url,publishedAt:Date.now(),content:n,raw:{url:e.url,status:t.status}}]}var f=r(7590);let E=s.Ik({summary:s.Yj(),entities:s.YO(s.Ik({name:s.Yj(),type:s.k5(["company","person","org","place","ticker","event","other"]).default("other"),relevance:s.ai().min(0).max(1).default(.5)})),sentiment:s.ai().min(-1).max(1),impact:s.Yj(),predictions:s.YO(s.Ik({scenario:s.Yj(),horizonHours:s.ai().int().min(1).max(168),probability:s.ai().min(0).max(1),confidence:s.k5(["low","medium","high"])}))});async function v(e){let t;let{item:r,companyOrEvent:s}=e,i=c.OPENAI_API_KEY??process.env.OPENAI_API_KEY,n=c.OPENAI_BASE_URL??process.env.OPENAI_BASE_URL;if(!i)return{summary:(r.title??"Update")+(r.url?` (${r.url})`:""),entities:[],sentiment:0,impact:"No LLM detected in environment; running in no-LLM mode.",predictions:[]};let a=new f.Ay({apiKey:i,baseURL:n}),o=s?`
Focus requested: ${s}`:"",l=`You are SignalForge, a high-signal analyst.

Input item:
- source: ${r.source}
- title: ${r.title??""}
- url: ${r.url??""}
- publishedAt: ${r.publishedAt?new Date(r.publishedAt).toISOString():""}
- content: ${r.content??""}
${o}

Return STRICT JSON matching this schema:
{
  "summary": string,
  "entities": [{"name": string, "type": "company"|"person"|"org"|"place"|"ticker"|"event"|"other", "relevance": number 0..1}],
  "sentiment": number -1..1,
  "impact": string,
  "predictions": [{"scenario": string, "horizonHours": number, "probability": number 0..1, "confidence": "low"|"medium"|"high"}]
}

Rules:
- Be concise but insightful.
- If uncertain, reduce probability and confidence.
- Prefer 2-4 predictions max.
`,d=await a.chat.completions.create({model:c.OPENAI_MODEL,messages:[{role:"system",content:"You output only valid JSON."},{role:"user",content:l}],temperature:.3}),u=d.choices[0]?.message?.content??"{}";try{t=JSON.parse(u)}catch{let e=u.match(/\{[\s\S]*\}/);t=e?JSON.parse(e[0]):{}}return E.parse(t)}let S=null;function N(){return S||(S=function(e){let t=d().dirname(e);t&&"."!==t&&!o().existsSync(t)&&o().mkdirSync(t,{recursive:!0});let r=new(n())(e);return r.pragma("journal_mode = WAL"),r.exec(`
    CREATE TABLE IF NOT EXISTS items (
      id TEXT PRIMARY KEY,
      source TEXT NOT NULL,
      kind TEXT NOT NULL,
      title TEXT,
      url TEXT,
      publishedAt INTEGER,
      content TEXT,
      rawJson TEXT,
      createdAt INTEGER NOT NULL
    );

    CREATE TABLE IF NOT EXISTS analyses (
      itemId TEXT PRIMARY KEY,
      summary TEXT NOT NULL,
      entitiesJson TEXT,
      sentiment REAL,
      impact TEXT,
      predictionsJson TEXT,
      updatedAt INTEGER NOT NULL,
      FOREIGN KEY(itemId) REFERENCES items(id) ON DELETE CASCADE
    );
  `),r}(c.SQLITE_PATH)),S}async function w(e){let t=function(e){try{let t=JSON.parse(e);return s.YO(s.gM("kind",[s.Ik({kind:s.eu("rss"),name:s.Yj(),url:s.Yj().url()}),s.Ik({kind:s.eu("web"),name:s.Yj(),url:s.Yj().url()}),s.Ik({kind:s.eu("twitter"),name:s.Yj(),handle:s.Yj(),provider:s.k5(["rsshub","nitter","auto"]).optional()})])).parse(t)}catch{return[]}}(c.SOURCES_JSON),r=[];for(let e of t)try{for(let t of(await h(e,{rsshubBaseUrl:c.RSSHUB_BASE_URL,nitterBaseUrl:c.NITTER_BASE_URL})))N().prepare(`
    INSERT INTO items (id, source, kind, title, url, publishedAt, content, rawJson, createdAt)
    VALUES (@id, @source, @kind, @title, @url, @publishedAt, @content, @rawJson, @createdAt)
    ON CONFLICT(id) DO UPDATE SET
      source=excluded.source,
      kind=excluded.kind,
      title=excluded.title,
      url=excluded.url,
      publishedAt=excluded.publishedAt,
      content=excluded.content,
      rawJson=excluded.rawJson
  `).run({id:t.id,source:t.source,kind:t.kind,title:t.title??null,url:t.url??null,publishedAt:t.publishedAt??null,content:t.content??null,rawJson:JSON.stringify(t.raw??null),createdAt:Date.now()}),r.push(t)}catch(t){console.error("source failed",e,t)}let i=N().prepare("SELECT id, source, kind, title, url, publishedAt, content, rawJson, createdAt FROM items ORDER BY COALESCE(publishedAt, createdAt) DESC LIMIT 15").all();for(let t of i){let r={id:t.id,source:t.source,kind:t.kind,title:t.title??void 0,url:t.url??void 0,publishedAt:t.publishedAt??void 0,content:t.content??void 0,raw:t.rawJson?JSON.parse(t.rawJson):null},s=await v({item:r,companyOrEvent:e});N().prepare(`
      INSERT INTO analyses (itemId, summary, entitiesJson, sentiment, impact, predictionsJson, updatedAt)
      VALUES (@itemId, @summary, @entitiesJson, @sentiment, @impact, @predictionsJson, @updatedAt)
      ON CONFLICT(itemId) DO UPDATE SET
        summary=excluded.summary,
        entitiesJson=excluded.entitiesJson,
        sentiment=excluded.sentiment,
        impact=excluded.impact,
        predictionsJson=excluded.predictionsJson,
        updatedAt=excluded.updatedAt
    `).run({itemId:r.id,summary:s.summary,entitiesJson:JSON.stringify(s.entities),sentiment:s.sentiment,impact:s.impact,predictionsJson:JSON.stringify(s.predictions),updatedAt:Date.now()})}return{ingested:r.length,analyzed:Math.min(i.length,15)}}},2704:()=>{}};var t=require("../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[994,117,403],()=>r(4602));module.exports=s})();